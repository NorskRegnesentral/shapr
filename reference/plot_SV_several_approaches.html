<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Shapley Value Bar Plots for Several Explanation Objects — plot_SV_several_approaches • shapr</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Shapley Value Bar Plots for Several Explanation Objects — plot_SV_several_approaches"><meta name="description" content="Make plots to visualize and compare the estimated Shapley values for a list of
explain() objects applied to the same data and model. For group-wise Shapley values,
the features values plotted are the mean feature values for all features in each group."><meta property="og:description" content="Make plots to visualize and compare the estimated Shapley values for a list of
explain() objects applied to the same data and model. For group-wise Shapley values,
the features values plotted are the mean feature values for all features in each group."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">shapr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/general_usage.html">General usage of shapr</a></li>
    <li><a class="dropdown-item" href="../articles/vaeac.html">Advanced usage of the `vaeac` approach</a></li>
    <li><a class="dropdown-item" href="../articles/regression.html">The separate and surrogate regression approches</a></li>
    <li><a class="dropdown-item" href="../articles/asymmetric_causal.html">Asymmetric and Causal Shapley values</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Manual</a></li>
<li class="nav-item"><a class="nav-link" href="../shaprpy.html">Python</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NorskRegnesentral/shapr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Shapley Value Bar Plots for Several Explanation Objects</h1>
      <small class="dont-index">Source: <a href="https://github.com/NorskRegnesentral/shapr/blob/v1.0.8/R/plot.R" class="external-link"><code>R/plot.R</code></a></small>
      <div class="d-none name"><code>plot_SV_several_approaches.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Make plots to visualize and compare the estimated Shapley values for a list of
<code><a href="explain.html">explain()</a></code> objects applied to the same data and model. For group-wise Shapley values,
the features values plotted are the mean feature values for all features in each group.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_SV_several_approaches</span><span class="op">(</span></span>
<span>  <span class="va">explanation_list</span>,</span>
<span>  index_explicands <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  index_explicands_sort <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  only_these_features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_phi0 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  print_ggplot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_zero_line <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  axis_labels_n_dodge <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  axis_labels_rotate_angle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  horizontal_bars <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  facet_scales <span class="op">=</span> <span class="st">"free"</span>,</span>
<span>  facet_ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  geom_col_width <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  brewer_palette <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  include_group_feature_means <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-explanation-list">explanation_list<a class="anchor" aria-label="anchor" href="#arg-explanation-list"></a></dt>
<dd><p>A list of <code><a href="explain.html">explain()</a></code> objects applied to the same data and model.
If the entries in the list are named, then the function use these names. Otherwise, they default to
the approach names (with integer suffix for duplicates) for the explanation objects in <code>explanation_list</code>.</p></dd>


<dt id="arg-index-explicands">index_explicands<a class="anchor" aria-label="anchor" href="#arg-index-explicands"></a></dt>
<dd><p>Integer vector. Which of the explicands (test observations) to plot.
E.g. if you have explained 10 observations using <code><a href="explain.html">explain()</a></code>, you can generate a plot for the
first 5 observations/explicands and the 10th by setting <code>index_x_explain = c(1:5, 10)</code>.
The argument <code>index_explicands_sort</code> must be <code>FALSE</code> to plot the explicand
in the order specified in <code>index_x_explain</code>.</p></dd>


<dt id="arg-index-explicands-sort">index_explicands_sort<a class="anchor" aria-label="anchor" href="#arg-index-explicands-sort"></a></dt>
<dd><p>Boolean. If <code>FALSE</code> (default), then <code>shapr</code> plots the explicands in the order
specified in <code>index_explicands</code>. If <code>TRUE</code>, then <code>shapr</code> sort the indices in increasing order based on their id.</p></dd>


<dt id="arg-only-these-features">only_these_features<a class="anchor" aria-label="anchor" href="#arg-only-these-features"></a></dt>
<dd><p>String vector. Containing the names of the features which
are to be included in the bar plots.</p></dd>


<dt id="arg-plot-phi-">plot_phi0<a class="anchor" aria-label="anchor" href="#arg-plot-phi-"></a></dt>
<dd><p>Boolean. If we are to include the \(\phi_0\) in the bar plots or not.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>Integer.
Number of significant digits to use in the feature description.
Applicable for <code>plot_type</code> <code>"bar"</code> and <code>"waterfall"</code></p></dd>


<dt id="arg-print-ggplot">print_ggplot<a class="anchor" aria-label="anchor" href="#arg-print-ggplot"></a></dt>
<dd><p>Logical.
Whether to print the created <code>ggplot</code> object once it is returned.
The default is <code>TRUE</code> which ensures the plot is always displayed also in loops, functions, when sourcing a script,
and when assigning the output to a variable like <code>p &lt;- plot.shapr(...)</code>.
See <code><a href="https://ggplot2.tidyverse.org/reference/print.ggplot.html" class="external-link">ggplot2::print.ggplot()</a></code> for more details.
If you wish to further modify the returned <code>ggplot</code> object outside of <code>plot.shapr</code>,
we recommend setting <code>print_ggplot = FALSE</code> to avoid force printing.
See the examples for a practical use case.</p></dd>


<dt id="arg-add-zero-line">add_zero_line<a class="anchor" aria-label="anchor" href="#arg-add-zero-line"></a></dt>
<dd><p>Boolean. If we are to add a black line for a feature contribution of 0.</p></dd>


<dt id="arg-axis-labels-n-dodge">axis_labels_n_dodge<a class="anchor" aria-label="anchor" href="#arg-axis-labels-n-dodge"></a></dt>
<dd><p>Integer. The number of rows that
should be used to render the labels. This is useful for displaying labels that would otherwise overlap.</p></dd>


<dt id="arg-axis-labels-rotate-angle">axis_labels_rotate_angle<a class="anchor" aria-label="anchor" href="#arg-axis-labels-rotate-angle"></a></dt>
<dd><p>Numeric. The angle of the axis label, where 0 means horizontal, 45 means tilted,
and 90 means vertical. Compared to setting the angle in <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code> / <code><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">ggplot2::element_text()</a></code>, this also
uses some heuristics to automatically pick the <code>hjust</code> and <code>vjust</code> that you probably want.</p></dd>


<dt id="arg-horizontal-bars">horizontal_bars<a class="anchor" aria-label="anchor" href="#arg-horizontal-bars"></a></dt>
<dd><p>Boolean. Flip Cartesian coordinates so that horizontal becomes vertical,
and vertical, horizontal. This is primarily useful for converting geoms and statistics which display
y conditional on x, to x conditional on y. See <code><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">ggplot2::coord_flip()</a></code>.</p></dd>


<dt id="arg-facet-scales">facet_scales<a class="anchor" aria-label="anchor" href="#arg-facet-scales"></a></dt>
<dd><p>Should scales be free ("<code>free</code>", the default), fixed ("<code>fixed</code>"), or free in one dimension
("<code>free_x</code>", "<code>free_y</code>")? The user has to change the latter manually depending on the value of <code>horizontal_bars</code>.</p></dd>


<dt id="arg-facet-ncol">facet_ncol<a class="anchor" aria-label="anchor" href="#arg-facet-ncol"></a></dt>
<dd><p>Integer. The number of columns in the facet grid. Default is <code>facet_ncol = 2</code>.</p></dd>


<dt id="arg-geom-col-width">geom_col_width<a class="anchor" aria-label="anchor" href="#arg-geom-col-width"></a></dt>
<dd><p>Numeric. Bar width. By default, set to 85% of the <code><a href="https://ggplot2.tidyverse.org/reference/resolution.html" class="external-link">ggplot2::resolution()</a></code> of the data.</p></dd>


<dt id="arg-brewer-palette">brewer_palette<a class="anchor" aria-label="anchor" href="#arg-brewer-palette"></a></dt>
<dd><p>String. Name of one of the color palettes from <code><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">RColorBrewer::RColorBrewer()</a></code>.
If <code>NULL</code>, then the function uses the default <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> color scheme.
The following palettes are available for use with these scales:</p><dl><dt>Diverging</dt>
<dd><p>BrBG, PiYG, PRGn, PuOr, RdBu, RdGy, RdYlBu, RdYlGn, Spectral</p></dd>

<dt>Qualitative</dt>
<dd><p>Accent, Dark2, Paired, Pastel1, Pastel2, Set1, Set2, Set3</p></dd>

<dt>Sequential</dt>
<dd><p>Blues, BuGn, BuPu, GnBu, Greens, Greys, Oranges,
OrRd, PuBu, PuBuGn, PuRd, Purples, RdPu, Reds, YlGn, YlGnBu, YlOrBr, YlOrRd</p></dd>


</dl></dd>


<dt id="arg-include-group-feature-means">include_group_feature_means<a class="anchor" aria-label="anchor" href="#arg-include-group-feature-means"></a></dt>
<dd><p>Logical. Whether to include the average feature value in a group on the
y-axis or not. If <code>FALSE</code> (default), then no value is shown for the groups. If <code>TRUE</code>, then <code>shapr</code> includes
the mean of the features in each group.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lars Henry Berge Olsen</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"xgboost"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Get the data</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"airquality"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Define the features and the response</span></span></span>
<span class="r-in"><span>  <span class="va">x_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Solar.R"</span>, <span class="st">"Wind"</span>, <span class="st">"Temp"</span>, <span class="st">"Month"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"Ozone"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Split data into test and training data set</span></span></span>
<span class="r-in"><span>  <span class="va">ind_x_explain</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span></span></span>
<span class="r-in"><span>  <span class="va">x_train</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">ind_x_explain</span>, <span class="va">..x_var</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">ind_x_explain</span>, <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">y_var</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">x_explain</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">ind_x_explain</span>, <span class="va">..x_var</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Fitting a basic xgboost model to the training data</span></span></span>
<span class="r-in"><span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgboost.html" class="external-link">xgboost</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="va">y_train</span>,</span></span>
<span class="r-in"><span>    nround <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    verbosity <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Specifying the phi_0, i.e. the expected prediction without any features</span></span></span>
<span class="r-in"><span>  <span class="va">phi0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y_train</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Independence approach</span></span></span>
<span class="r-in"><span>  <span class="va">explanation_independence</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>    x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>    x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>    approach <span class="op">=</span> <span class="st">"independence"</span>,</span></span>
<span class="r-in"><span>    phi0 <span class="op">=</span> <span class="va">phi0</span>,</span></span>
<span class="r-in"><span>    n_MC_samples <span class="op">=</span> <span class="fl">1e2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Empirical approach</span></span></span>
<span class="r-in"><span>  <span class="va">explanation_empirical</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>    x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>    x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>    approach <span class="op">=</span> <span class="st">"empirical"</span>,</span></span>
<span class="r-in"><span>    phi0 <span class="op">=</span> <span class="va">phi0</span>,</span></span>
<span class="r-in"><span>    n_MC_samples <span class="op">=</span> <span class="fl">1e2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Gaussian 1e1 approach</span></span></span>
<span class="r-in"><span>  <span class="va">explanation_gaussian_1e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>    x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>    x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>    approach <span class="op">=</span> <span class="st">"gaussian"</span>,</span></span>
<span class="r-in"><span>    phi0 <span class="op">=</span> <span class="va">phi0</span>,</span></span>
<span class="r-in"><span>    n_MC_samples <span class="op">=</span> <span class="fl">1e1</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Gaussian 1e2 approach</span></span></span>
<span class="r-in"><span>  <span class="va">explanation_gaussian_1e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>    x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>    x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>    approach <span class="op">=</span> <span class="st">"gaussian"</span>,</span></span>
<span class="r-in"><span>    phi0 <span class="op">=</span> <span class="va">phi0</span>,</span></span>
<span class="r-in"><span>    n_MC_samples <span class="op">=</span> <span class="fl">1e2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Combined approach</span></span></span>
<span class="r-in"><span>  <span class="va">explanation_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>    x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>    x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>    approach <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"ctree"</span>, <span class="st">"empirical"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    phi0 <span class="op">=</span> <span class="va">phi0</span>,</span></span>
<span class="r-in"><span>    n_MC_samples <span class="op">=</span> <span class="fl">1e2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Create a list of explanations with names</span></span></span>
<span class="r-in"><span>  <span class="va">explanation_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Ind."</span> <span class="op">=</span> <span class="va">explanation_independence</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Emp."</span> <span class="op">=</span> <span class="va">explanation_empirical</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Gaus. 1e1"</span> <span class="op">=</span> <span class="va">explanation_gaussian_1e1</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Gaus. 1e2"</span> <span class="op">=</span> <span class="va">explanation_gaussian_1e2</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Combined"</span> <span class="op">=</span> <span class="va">explanation_combined</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The function uses the provided names.</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_SV_several_approaches</span><span class="op">(</span><span class="va">explanation_list</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can change the number of columns in the grid of plots and add other visual alterations</span></span></span>
<span class="r-in"><span>  <span class="co"># Set `print_ggplot = FALSE` to avoid force displaying the ggplot object before the modifications</span></span></span>
<span class="r-in"><span>  <span class="co"># outside plot_SV_several_approaches()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">plot_SV_several_approaches</span><span class="op">(</span><span class="va">explanation_list</span>,</span></span>
<span class="r-in"><span>    facet_ncol <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    facet_scales <span class="op">=</span> <span class="st">"free_y"</span>,</span></span>
<span class="r-in"><span>    add_zero_line <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    digits <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    brewer_palette <span class="op">=</span> <span class="st">"Paired"</span>,</span></span>
<span class="r-in"><span>    geom_col_width <span class="op">=</span> <span class="fl">0.6</span>,</span></span>
<span class="r-in"><span>    print_ggplot <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can specify which explicands to plot to get less chaotic plots and make the bars vertical</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_SV_several_approaches</span><span class="op">(</span><span class="va">explanation_list</span>,</span></span>
<span class="r-in"><span>    index_explicands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    horizontal_bars <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    axis_labels_rotate_angle <span class="op">=</span> <span class="fl">45</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can change the order of the features by specifying the</span></span></span>
<span class="r-in"><span>  <span class="co"># order using the `only_these_features` parameter.</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_SV_several_approaches</span><span class="op">(</span><span class="va">explanation_list</span>,</span></span>
<span class="r-in"><span>    index_explicands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    only_these_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Temp"</span>, <span class="st">"Solar.R"</span>, <span class="st">"Month"</span>, <span class="st">"Wind"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can also remove certain features if we are not interested in them</span></span></span>
<span class="r-in"><span>  <span class="co"># or want to focus on, e.g., two features. The function will give a</span></span></span>
<span class="r-in"><span>  <span class="co"># message to if the user specifies non-valid feature names.</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_SV_several_approaches</span><span class="op">(</span><span class="va">explanation_list</span>,</span></span>
<span class="r-in"><span>    index_explicands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    only_these_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Temp"</span>, <span class="st">"Solar.R"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    plot_phi0 <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Jullum, Lars Henry Berge Olsen, Annabelle Redelmeier, Jon Lachmann, Nikolai Sellereite, Norsk Regnesentral.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

