<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Shapley value bar plots for several explanation objects — plot_SV_several_approaches • shapr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Shapley value bar plots for several explanation objects — plot_SV_several_approaches"><meta property="og:description" content="Make plots to visualize and compare the estimated Shapley values for a list of
explain() objects applied to the same data and model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shapr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.3.9200</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/understanding_shapr.html">General usage of shapr</a>
    </li>
    <li>
      <a href="../articles/understanding_shapr_vaeac.html">Advanced usage of the `vaeac` approach</a>
    </li>
    <li>
      <a href="../articles/understanding_shapr_regression.html">The separate and surrogate regression approches</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/NorskRegnesentral/shapr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Shapley value bar plots for several explanation objects</h1>
    <small class="dont-index">Source: <a href="https://github.com/NorskRegnesentral/shapr/blob/HEAD/R/plot.R" class="external-link"><code>R/plot.R</code></a></small>
    <div class="hidden name"><code>plot_SV_several_approaches.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Make plots to visualize and compare the estimated Shapley values for a list of
<code><a href="explain.html">explain()</a></code> objects applied to the same data and model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_SV_several_approaches</span><span class="op">(</span></span>
<span>  <span class="va">explanation_list</span>,</span>
<span>  index_explicands <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  only_these_features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_phi0 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  add_zero_line <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  axis_labels_n_dodge <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  axis_labels_rotate_angle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  horizontal_bars <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  facet_scales <span class="op">=</span> <span class="st">"free"</span>,</span>
<span>  facet_ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  geom_col_width <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  brewer_palette <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>explanation_list</dt>
<dd><p>A list of <code><a href="explain.html">explain()</a></code> objects applied to the same data and model.
If the entries in the list is named, then the function use these names. Otherwise, it defaults to
the approach names (with integer suffix for duplicates) for the explanation objects in <code>explanation_list</code>.</p></dd>


<dt>index_explicands</dt>
<dd><p>Integer vector. Which of the explicands (test observations) to plot.
E.g. if you have explained 10 observations using <code><a href="explain.html">explain()</a></code>, you can generate a plot for the
first 5 observations/explicands and the 10th by setting <code>index_x_explain = c(1:5, 10)</code>.</p></dd>


<dt>only_these_features</dt>
<dd><p>String vector. Containing the names of the features which
are to be included in the bar plots.</p></dd>


<dt>plot_phi0</dt>
<dd><p>Boolean. If we are to include the \(\phi_0\) in the bar plots or not.</p></dd>


<dt>digits</dt>
<dd><p>Integer. Number of significant digits to use in the feature description.</p></dd>


<dt>add_zero_line</dt>
<dd><p>Boolean. If we are to add a black line for a feature contribution of 0.</p></dd>


<dt>axis_labels_n_dodge</dt>
<dd><p>Integer. The number of rows that
should be used to render the labels. This is useful for displaying labels that would otherwise overlap.</p></dd>


<dt>axis_labels_rotate_angle</dt>
<dd><p>Numeric. The angle of the axis label, where 0 means horizontal, 45 means tilted,
and 90 means vertical. Compared to setting the angle in<code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code> / <code><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">ggplot2::element_text()</a></code>, this also
uses some heuristics to automatically pick the <code>hjust</code> and <code>vjust</code> that you probably want.</p></dd>


<dt>horizontal_bars</dt>
<dd><p>Boolean. Flip Cartesian coordinates so that horizontal becomes vertical,
and vertical, horizontal. This is primarily useful for converting geoms and statistics which display
y conditional on x, to x conditional on y. See <code><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">ggplot2::coord_flip()</a></code>.</p></dd>


<dt>facet_scales</dt>
<dd><p>Should scales be free ("<code>free</code>", the default), fixed ("<code>fixed</code>"), or free in one dimension
("<code>free_x</code>", "<code>free_y</code>")? The user has to change the latter manually depending on the value of <code>horizontal_bars</code>.</p></dd>


<dt>facet_ncol</dt>
<dd><p>Integer. The number of columns in the facet grid. Default is <code>facet_ncol = 2</code>.</p></dd>


<dt>geom_col_width</dt>
<dd><p>Numeric. Bar width. By default, set to 85% of the <code><a href="https://ggplot2.tidyverse.org/reference/resolution.html" class="external-link">ggplot2::resolution()</a></code> of the data.</p></dd>


<dt>brewer_palette</dt>
<dd><p>String. Name of one of the color palettes from <code><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">RColorBrewer::RColorBrewer()</a></code>.
If <code>NULL</code>, then the function uses the default <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> color scheme.
The following palettes are available for use with these scales:</p><dl><dt>Diverging</dt>
<dd><p>BrBG, PiYG, PRGn, PuOr, RdBu, RdGy, RdYlBu, RdYlGn, Spectral</p></dd>

<dt>Qualitative</dt>
<dd><p>Accent, Dark2, Paired, Pastel1, Pastel2, Set1, Set2, Set3</p></dd>

<dt>Sequential</dt>
<dd><p>Blues, BuGn, BuPu, GnBu, Greens, Greys, Oranges,
OrRd, PuBu, PuBuGn, PuRd, Purples, RdPu, Reds, YlGn, YlGnBu, YlOrBr, YlOrRd</p></dd>


</dl></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> object.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Lars Henry Berge Olsen</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load necessary libraries</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmlc/xgboost" class="external-link">xgboost</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"airquality"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define the features and the response</span></span></span>
<span class="r-in"><span><span class="va">x_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Solar.R"</span>, <span class="st">"Wind"</span>, <span class="st">"Temp"</span>, <span class="st">"Month"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"Ozone"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Split data into test and training data set</span></span></span>
<span class="r-in"><span><span class="va">ind_x_explain</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span></span></span>
<span class="r-in"><span><span class="va">x_train</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">ind_x_explain</span>, <span class="va">..x_var</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">ind_x_explain</span>, <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">y_var</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">x_explain</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">ind_x_explain</span>, <span class="va">..x_var</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fitting a basic xgboost model to the training data</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html" class="external-link">xgboost</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x_train</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  label <span class="op">=</span> <span class="va">y_train</span>,</span></span>
<span class="r-in"><span>  nround <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specifying the phi_0, i.e. the expected prediction without any features</span></span></span>
<span class="r-in"><span><span class="va">prediction_zero</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y_train</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Independence approach</span></span></span>
<span class="r-in"><span><span class="va">explanation_independence</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>  x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>  approach <span class="op">=</span> <span class="st">"independence"</span>,</span></span>
<span class="r-in"><span>  prediction_zero <span class="op">=</span> <span class="va">prediction_zero</span>,</span></span>
<span class="r-in"><span>  n_samples <span class="op">=</span> <span class="fl">1e2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: Feature classes extracted from the model contains NA.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming feature classes from the data are correct.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting parameter 'n_batches' to 2 as a fair trade-off between memory consumption and computation time.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reducing 'n_batches' typically reduces the computation time at the cost of increased memory consumption.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Empirical approach</span></span></span>
<span class="r-in"><span><span class="va">explanation_empirical</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>  x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>  approach <span class="op">=</span> <span class="st">"empirical"</span>,</span></span>
<span class="r-in"><span>  prediction_zero <span class="op">=</span> <span class="va">prediction_zero</span>,</span></span>
<span class="r-in"><span>  n_samples <span class="op">=</span> <span class="fl">1e2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: Feature classes extracted from the model contains NA.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming feature classes from the data are correct.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting parameter 'n_batches' to 2 as a fair trade-off between memory consumption and computation time.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reducing 'n_batches' typically reduces the computation time at the cost of increased memory consumption.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Gaussian 1e1 approach</span></span></span>
<span class="r-in"><span><span class="va">explanation_gaussian_1e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>  x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>  approach <span class="op">=</span> <span class="st">"gaussian"</span>,</span></span>
<span class="r-in"><span>  prediction_zero <span class="op">=</span> <span class="va">prediction_zero</span>,</span></span>
<span class="r-in"><span>  n_samples <span class="op">=</span> <span class="fl">1e1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: Feature classes extracted from the model contains NA.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming feature classes from the data are correct.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting parameter 'n_batches' to 10 as a fair trade-off between memory consumption and computation time.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reducing 'n_batches' typically reduces the computation time at the cost of increased memory consumption.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Gaussian 1e2 approach</span></span></span>
<span class="r-in"><span><span class="va">explanation_gaussian_1e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>  x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>  approach <span class="op">=</span> <span class="st">"gaussian"</span>,</span></span>
<span class="r-in"><span>  prediction_zero <span class="op">=</span> <span class="va">prediction_zero</span>,</span></span>
<span class="r-in"><span>  n_samples <span class="op">=</span> <span class="fl">1e2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: Feature classes extracted from the model contains NA.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming feature classes from the data are correct.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting parameter 'n_batches' to 10 as a fair trade-off between memory consumption and computation time.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reducing 'n_batches' typically reduces the computation time at the cost of increased memory consumption.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Combined approach</span></span></span>
<span class="r-in"><span><span class="va">explanation_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>  x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>  approach <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"ctree"</span>, <span class="st">"empirical"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prediction_zero <span class="op">=</span> <span class="va">prediction_zero</span>,</span></span>
<span class="r-in"><span>  n_samples <span class="op">=</span> <span class="fl">1e2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: Feature classes extracted from the model contains NA.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming feature classes from the data are correct.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting parameter 'n_batches' to 10 as a fair trade-off between memory consumption and computation time.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reducing 'n_batches' typically reduces the computation time at the cost of increased memory consumption.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a list of explanations with names</span></span></span>
<span class="r-in"><span><span class="va">explanation_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"Ind."</span> <span class="op">=</span> <span class="va">explanation_independence</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Emp."</span> <span class="op">=</span> <span class="va">explanation_empirical</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Gaus. 1e1"</span> <span class="op">=</span> <span class="va">explanation_gaussian_1e1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Gaus. 1e2"</span> <span class="op">=</span> <span class="va">explanation_gaussian_1e2</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Combined"</span> <span class="op">=</span> <span class="va">explanation_combined</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># The function uses the provided names.</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_SV_several_approaches</span><span class="op">(</span><span class="va">explanation_list</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can change the number of columns in the grid of plots and add other visual alterations</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_SV_several_approaches</span><span class="op">(</span><span class="va">explanation_list</span>,</span></span>
<span class="r-in"><span>    facet_ncol <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    facet_scales <span class="op">=</span> <span class="st">"free_y"</span>,</span></span>
<span class="r-in"><span>    add_zero_line <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    digits <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    brewer_palette <span class="op">=</span> <span class="st">"Paired"</span>,</span></span>
<span class="r-in"><span>    geom_col_width <span class="op">=</span> <span class="fl">0.6</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can specify which explicands to plot to get less chaotic plots and make the bars vertical</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_SV_several_approaches</span><span class="op">(</span><span class="va">explanation_list</span>,</span></span>
<span class="r-in"><span>    index_explicands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    horizontal_bars <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    axis_labels_rotate_angle <span class="op">=</span> <span class="fl">45</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can change the order of the features by specifying the</span></span></span>
<span class="r-in"><span>  <span class="co"># order using the `only_these_features` parameter.</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_SV_several_approaches</span><span class="op">(</span><span class="va">explanation_list</span>,</span></span>
<span class="r-in"><span>    index_explicands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    only_these_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Temp"</span>, <span class="st">"Solar.R"</span>, <span class="st">"Month"</span>, <span class="st">"Wind"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can also remove certain features if we are not interested in them</span></span></span>
<span class="r-in"><span>  <span class="co"># or want to focus on, e.g., two features. The function will give a</span></span></span>
<span class="r-in"><span>  <span class="co"># message to if the user specifies non-valid feature names.</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_SV_several_approaches</span><span class="op">(</span><span class="va">explanation_list</span>,</span></span>
<span class="r-in"><span>    index_explicands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    only_these_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Temp"</span>, <span class="st">"Solar.R"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    plot_phi0 <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="plot_SV_several_approaches-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nikolai Sellereite, Martin Jullum, Lars Henry Berge Olsen, Annabelle Redelmeier, Jon Lachmann, Norsk Regnesentral.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

      </footer></div>

  


  

  </body></html>

