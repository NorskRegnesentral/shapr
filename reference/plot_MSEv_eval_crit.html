<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plots of the MSEv Evaluation Criterion — plot_MSEv_eval_crit • shapr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plots of the MSEv Evaluation Criterion — plot_MSEv_eval_crit"><meta property="og:description" content="Make plots to visualize and compare the MSEv evaluation criterion for a list of
explain() objects applied to the same data and model. The function creates
bar plots and line plots with points to illustrate the overall MSEv evaluation
criterion, but also for each observation/explicand and combination by only averaging over
the combinations and observations/explicands, respectively."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shapr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.3.9200</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/understanding_shapr.html">Explaining individual machine learning predictions with Shapley values</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/NorskRegnesentral/shapr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plots of the MSEv Evaluation Criterion</h1>
    <small class="dont-index">Source: <a href="https://github.com/NorskRegnesentral/shapr/blob/HEAD/R/plot.R" class="external-link"><code>R/plot.R</code></a></small>
    <div class="hidden name"><code>plot_MSEv_eval_crit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Make plots to visualize and compare the MSEv evaluation criterion for a list of
<code><a href="explain.html">explain()</a></code> objects applied to the same data and model. The function creates
bar plots and line plots with points to illustrate the overall MSEv evaluation
criterion, but also for each observation/explicand and combination by only averaging over
the combinations and observations/explicands, respectively.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_MSEv_eval_crit</span><span class="op">(</span></span>
<span>  <span class="va">explanation_list</span>,</span>
<span>  index_x_explain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id_combination <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  CI_level <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">explanation_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pred_explain</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">20</span><span class="op">)</span> <span class="cn">NULL</span> <span class="kw">else</span> <span class="fl">0.95</span>,</span>
<span>  geom_col_width <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"overall"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>explanation_list</dt>
<dd><p>A list of <code><a href="explain.html">explain()</a></code> objects applied to the same data and model.
If the entries in the list are named, then the function use these names. Otherwise, they default to
the approach names (with integer suffix for duplicates) for the explanation objects in <code>explanation_list</code>.</p></dd>


<dt>index_x_explain</dt>
<dd><p>Integer vector.
Which of the test observations to plot. E.g. if you have
explained 10 observations using <code><a href="explain.html">explain()</a></code>, you can generate a plot for the first 5
observations by setting <code>index_x_explain = 1:5</code>.</p></dd>


<dt>id_combination</dt>
<dd><p>Integer vector. Which of the combinations (coalitions) to plot.
E.g. if you used <code>n_combinations = 16</code> in <code><a href="explain.html">explain()</a></code>, you can generate a plot for the
first 5 combinations and the 10th by setting <code>id_combination = c(1:5, 10)</code>.</p></dd>


<dt>CI_level</dt>
<dd><p>Positive numeric between zero and one. Default is <code>0.95</code> if the number of observations to explain is
larger than 20, otherwise <code>CI_level = NULL</code>, which removes the confidence intervals. The level of the approximate
confidence intervals for the overall MSEv and the MSEv_combination. The confidence intervals are based on that
the MSEv scores are means over the observations/explicands, and that means are approximation normal. Since the
standard deviations are estimated, we use the quantile t from the T distribution with N_explicands - 1 degrees of
freedom corresponding to the provided level. Here, N_explicands is the number of observations/explicands.
MSEv ± t<em>SD(MSEv)/sqrt(N_explicands). Note that the <code><a href="explain.html">explain()</a></code> function already scales the standard deviation by
sqrt(N_explicands), thus, the CI are MSEv ± t</em>MSEv_sd, where the values MSEv and MSEv_sd are extracted from the
MSEv data.tables in the objects in the <code>explanation_list</code>.</p></dd>


<dt>geom_col_width</dt>
<dd><p>Numeric. Bar width. By default, set to 90% of the <code><a href="https://ggplot2.tidyverse.org/reference/resolution.html" class="external-link">ggplot2::resolution()</a></code> of the data.</p></dd>


<dt>plot_type</dt>
<dd><p>Character vector. The possible options are "overall" (default), "comb", and "explicand".
If <code>plot_type = "overall"</code>, then the plot (one bar plot) associated with the overall MSEv evaluation criterion
for each method is created, i.e., when averaging over both the combinations/coalitions and observations/explicands.
If <code>plot_type = "comb"</code>, then the plots (one line plot and one bar plot) associated with the MSEv evaluation
criterion for each combination/coalition are created, i.e., when we only average over the observations/explicands.
If <code>plot_type = "explicand"</code>, then the plots (one line plot and one bar plot) associated with the MSEv evaluation
criterion for each observations/explicands are created, i.e., when we only average over the combinations/coalitions.
If <code>plot_type</code> is a vector of one or several of "overall", "comb", and "explicand", then the associated plots are
created.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Either a single <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> object of the MSEv criterion when <code>plot_type = "overall"</code>, or a list
of <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> objects based on the <code>plot_type</code> parameter.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Lars Henry Berge Olsen</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load necessary librarieslibrary(xgboost)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://norskregnesentral.github.io/shapr/">shapr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"airquality"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#' Define the features and the response</span></span></span>
<span class="r-in"><span><span class="va">x_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Solar.R"</span>, <span class="st">"Wind"</span>, <span class="st">"Temp"</span>, <span class="st">"Month"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"Ozone"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Split data into test and training data set</span></span></span>
<span class="r-in"><span><span class="va">ind_x_explain</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">25</span></span></span>
<span class="r-in"><span><span class="va">x_train</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">ind_x_explain</span>, <span class="va">..x_var</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">ind_x_explain</span>, <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">y_var</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">x_explain</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">ind_x_explain</span>, <span class="va">..x_var</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fitting a basic xgboost model to the training data</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html" class="external-link">xgboost</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x_train</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  label <span class="op">=</span> <span class="va">y_train</span>,</span></span>
<span class="r-in"><span>  nround <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specifying the phi_0, i.e. the expected prediction without any features</span></span></span>
<span class="r-in"><span><span class="va">prediction_zero</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y_train</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Independence approach</span></span></span>
<span class="r-in"><span><span class="va">explanation_independence</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>  x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>  approach <span class="op">=</span> <span class="st">"independence"</span>,</span></span>
<span class="r-in"><span>  prediction_zero <span class="op">=</span> <span class="va">prediction_zero</span>,</span></span>
<span class="r-in"><span>  n_samples <span class="op">=</span> <span class="fl">1e2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: Feature classes extracted from the model contains NA.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming feature classes from the data are correct.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting parameter 'n_batches' to 2 as a fair trade-off between memory consumption and computation time.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reducing 'n_batches' typically reduces the computation time at the cost of increased memory consumption.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Gaussian 1e1 approach</span></span></span>
<span class="r-in"><span><span class="va">explanation_gaussian_1e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>  x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>  approach <span class="op">=</span> <span class="st">"gaussian"</span>,</span></span>
<span class="r-in"><span>  prediction_zero <span class="op">=</span> <span class="va">prediction_zero</span>,</span></span>
<span class="r-in"><span>  n_samples <span class="op">=</span> <span class="fl">1e1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: Feature classes extracted from the model contains NA.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming feature classes from the data are correct.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting parameter 'n_batches' to 10 as a fair trade-off between memory consumption and computation time.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reducing 'n_batches' typically reduces the computation time at the cost of increased memory consumption.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Gaussian 1e2 approach</span></span></span>
<span class="r-in"><span><span class="va">explanation_gaussian_1e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>  x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>  approach <span class="op">=</span> <span class="st">"gaussian"</span>,</span></span>
<span class="r-in"><span>  prediction_zero <span class="op">=</span> <span class="va">prediction_zero</span>,</span></span>
<span class="r-in"><span>  n_samples <span class="op">=</span> <span class="fl">1e2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: Feature classes extracted from the model contains NA.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming feature classes from the data are correct.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting parameter 'n_batches' to 10 as a fair trade-off between memory consumption and computation time.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reducing 'n_batches' typically reduces the computation time at the cost of increased memory consumption.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ctree approach</span></span></span>
<span class="r-in"><span><span class="va">explanation_ctree</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>  x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>  approach <span class="op">=</span> <span class="st">"ctree"</span>,</span></span>
<span class="r-in"><span>  prediction_zero <span class="op">=</span> <span class="va">prediction_zero</span>,</span></span>
<span class="r-in"><span>  n_samples <span class="op">=</span> <span class="fl">1e2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: Feature classes extracted from the model contains NA.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming feature classes from the data are correct.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting parameter 'n_batches' to 10 as a fair trade-off between memory consumption and computation time.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reducing 'n_batches' typically reduces the computation time at the cost of increased memory consumption.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Combined approach</span></span></span>
<span class="r-in"><span><span class="va">explanation_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="explain.html">explain</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  x_explain <span class="op">=</span> <span class="va">x_explain</span>,</span></span>
<span class="r-in"><span>  x_train <span class="op">=</span> <span class="va">x_train</span>,</span></span>
<span class="r-in"><span>  approach <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"independence"</span>, <span class="st">"ctree"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prediction_zero <span class="op">=</span> <span class="va">prediction_zero</span>,</span></span>
<span class="r-in"><span>  n_samples <span class="op">=</span> <span class="fl">1e2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: Feature classes extracted from the model contains NA.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming feature classes from the data are correct.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting parameter 'n_batches' to 10 as a fair trade-off between memory consumption and computation time.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reducing 'n_batches' typically reduces the computation time at the cost of increased memory consumption.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a list of explanations with names</span></span></span>
<span class="r-in"><span><span class="va">explanation_list_named</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"Ind."</span> <span class="op">=</span> <span class="va">explanation_independence</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Gaus. 1e1"</span> <span class="op">=</span> <span class="va">explanation_gaussian_1e1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Gaus. 1e2"</span> <span class="op">=</span> <span class="va">explanation_gaussian_1e2</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Ctree"</span> <span class="op">=</span> <span class="va">explanation_ctree</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Combined"</span> <span class="op">=</span> <span class="va">explanation_combined</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Create the default MSEv plot where we average over both the combinations and observations</span></span></span>
<span class="r-in"><span>  <span class="co"># with approximate 95% confidence intervals</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_MSEv_eval_crit</span><span class="op">(</span><span class="va">explanation_list_named</span>, CI_level <span class="op">=</span> <span class="fl">0.95</span>, plot_type <span class="op">=</span> <span class="st">"overall"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Can also create plots of the MSEv criterion averaged only over the combinations or observations.</span></span></span>
<span class="r-in"><span>  <span class="va">MSEv_figures</span> <span class="op">&lt;-</span> <span class="fu">plot_MSEv_eval_crit</span><span class="op">(</span><span class="va">explanation_list_named</span>,</span></span>
<span class="r-in"><span>    CI_level <span class="op">=</span> <span class="fl">0.95</span>,</span></span>
<span class="r-in"><span>    plot_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"overall"</span>, <span class="st">"comb"</span>, <span class="st">"explicand"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">MSEv_figures</span><span class="op">$</span><span class="va">MSEv_bar</span></span></span>
<span class="r-in"><span>  <span class="va">MSEv_figures</span><span class="op">$</span><span class="va">MSEv_combination_bar</span></span></span>
<span class="r-in"><span>  <span class="va">MSEv_figures</span><span class="op">$</span><span class="va">MSEv_explicand_bar</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># When there are many combinations or observations, then it can be easier to look at line plots</span></span></span>
<span class="r-in"><span>  <span class="va">MSEv_figures</span><span class="op">$</span><span class="va">MSEv_combination_line_point</span></span></span>
<span class="r-in"><span>  <span class="va">MSEv_figures</span><span class="op">$</span><span class="va">MSEv_explicand_line_point</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can specify which observations or combinations to plot</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_MSEv_eval_crit</span><span class="op">(</span><span class="va">explanation_list_named</span>,</span></span>
<span class="r-in"><span>    plot_type <span class="op">=</span> <span class="st">"explicand"</span>,</span></span>
<span class="r-in"><span>    index_x_explain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    CI_level <span class="op">=</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">$</span><span class="va">MSEv_explicand_bar</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_MSEv_eval_crit</span><span class="op">(</span><span class="va">explanation_list_named</span>,</span></span>
<span class="r-in"><span>    plot_type <span class="op">=</span> <span class="st">"comb"</span>,</span></span>
<span class="r-in"><span>    id_combination <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">13</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    CI_level <span class="op">=</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">$</span><span class="va">MSEv_combination_bar</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can alter the figures if other palette schemes or design is wanted</span></span></span>
<span class="r-in"><span>  <span class="va">bar_text_n_decimals</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="va">MSEv_figures</span><span class="op">$</span><span class="va">MSEv_bar</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">MSEv_figures</span><span class="op">$</span><span class="va">MSEv_bar</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">Method</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_fill_discrete</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co">#' Default ggplot2 palette</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co">#' This must be set before the other theme call</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      legend.position <span class="op">=</span> <span class="st">"bottom"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"%."</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%d"</span>, <span class="va">bar_text_n_decimals</span><span class="op">)</span>, <span class="st">"f"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">MSEv</span>, <span class="va">bar_text_n_decimals</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1.1</span>, <span class="co"># This value must be altered based on the plot dimension</span></span></span>
<span class="r-in"><span>      hjust <span class="op">=</span> <span class="fl">1.1</span>, <span class="co"># This value must be altered based on the plot dimension</span></span></span>
<span class="r-in"><span>      color <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>      position <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      size <span class="op">=</span> <span class="fl">5</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="plot_MSEv_eval_crit-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nikolai Sellereite, Martin Jullum, Lars Henry Berge Olsen, Annabelle Redelmeier, Jon Lachmann, Norsk Regnesentral.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

