<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Function used to train a vaeac model — vaeac_train_model_auxiliary • shapr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Function used to train a vaeac model — vaeac_train_model_auxiliary"><meta property="og:description" content="This function can be applied both in the initialization phase when, we train several initiated vaeac models, and
to keep training the best performing vaeac model for the remaining number of epochs. We are in the former setting
when initialization_idx is provided and the latter when it is NULL. When it is NULL, we save the vaeac models
with lowest VLB, IWAE, running IWAE, and the epochs according to save_every_nth_epoch to disk."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shapr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.3.9200</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/understanding_shapr.html">General usage of shapr</a>
    </li>
    <li>
      <a href="../articles/understanding_shapr_vaeac.html">Advanced usage of the `vaeac` approach</a>
    </li>
    <li>
      <a href="../articles/understanding_shapr_regression.html">The separate and surrogate regression approches</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/NorskRegnesentral/shapr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function used to train a <code>vaeac</code> model</h1>
    <small class="dont-index">Source: <a href="https://github.com/NorskRegnesentral/shapr/blob/HEAD/R/approach_vaeac.R" class="external-link"><code>R/approach_vaeac.R</code></a></small>
    <div class="hidden name"><code>vaeac_train_model_auxiliary.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function can be applied both in the initialization phase when, we train several initiated <code>vaeac</code> models, and
to keep training the best performing <code>vaeac</code> model for the remaining number of epochs. We are in the former setting
when <code>initialization_idx</code> is provided and the latter when it is <code>NULL</code>. When it is <code>NULL</code>, we save the <code>vaeac</code> models
with lowest VLB, IWAE, running IWAE, and the epochs according to <code>save_every_nth_epoch</code> to disk.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vaeac_train_model_auxiliary</span><span class="op">(</span></span>
<span>  <span class="va">vaeac_model</span>,</span>
<span>  <span class="va">optimizer</span>,</span>
<span>  <span class="va">train_dataloader</span>,</span>
<span>  <span class="va">val_dataloader</span>,</span>
<span>  <span class="va">val_iwae_n_samples</span>,</span>
<span>  <span class="va">running_avg_n_values</span>,</span>
<span>  <span class="va">verbose</span>,</span>
<span>  <span class="va">cuda</span>,</span>
<span>  <span class="va">epochs</span>,</span>
<span>  <span class="va">save_every_nth_epoch</span>,</span>
<span>  <span class="va">epochs_early_stopping</span>,</span>
<span>  epochs_start <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  progressr_bar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vaeac_save_file_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  state_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  initialization_idx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_vaeacs_initialize <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  train_vlb <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  val_iwae <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  val_iwae_running <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>vaeac_model</dt>
<dd><p>A <code><a href="vaeac.html">vaeac()</a></code> object. The <code>vaeac</code> model this function is to train.</p></dd>


<dt>optimizer</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/torch/man/optimizer.html" class="external-link">torch::optimizer()</a></code> object. See <code><a href="vaeac_get_optimizer.html">vaeac_get_optimizer()</a></code>.</p></dd>


<dt>train_dataloader</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/torch/man/dataloader.html" class="external-link">torch::dataloader()</a></code> containing the training data for the <code>vaeac</code> model.</p></dd>


<dt>val_dataloader</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/torch/man/dataloader.html" class="external-link">torch::dataloader()</a></code> containing the validation data for the <code>vaeac</code> model.</p></dd>


<dt>val_iwae_n_samples</dt>
<dd><p>Positive integer (default is <code>25</code>). The number of generated samples used
to compute the IWAE criterion when validating the vaeac model on the validation data.</p></dd>


<dt>running_avg_n_values</dt>
<dd><p>running_avg_n_values Positive integer (default is <code>5</code>).
The number of previous IWAE values to include
when we compute the running means of the IWAE criterion.</p></dd>


<dt>verbose</dt>
<dd><p>Boolean. An integer specifying the level of verbosity. Use <code>0</code> (default) for no verbosity,
<code>1</code> for low verbose, and <code>2</code> for high verbose.</p></dd>


<dt>cuda</dt>
<dd><p>Logical (default is <code>FALSE</code>). If <code>TRUE</code>, then the <code>vaeac</code> model will be trained using cuda/GPU.
If <code><a href="https://rdrr.io/pkg/torch/man/cuda_is_available.html" class="external-link">torch::cuda_is_available()</a></code> is <code>FALSE</code>, the we fall back to use CPU. If <code>FALSE</code>, we use the CPU. Using a GPU
for smaller tabular dataset often do not improve the efficiency.
See <code><a href="https://cran.rstudio.com/web/packages/torch/vignettes/installation.html" class="external-link">vignette("installation", package = "torch")</a></code> fo help to enable running on the GPU (only Linux and Windows).</p></dd>


<dt>epochs</dt>
<dd><p>Positive integer (default is <code>100</code>). The number of epochs to train the final vaeac model.
This includes <code>epochs_initiation_phase</code>, where the default is <code>2</code>.</p></dd>


<dt>save_every_nth_epoch</dt>
<dd><p>Positive integer (default is <code>NULL</code>). If provided, then the vaeac model after
every <code>save_every_nth_epoch</code>th epoch will be saved.</p></dd>


<dt>epochs_early_stopping</dt>
<dd><p>Positive integer (default is <code>NULL</code>). The training stops if there has been no
improvement in the validation IWAE for <code>epochs_early_stopping</code> epochs. If the user wants the training process
to be solely based on this training criterion, then <code>epochs</code> in <code><a href="explain.html">explain()</a></code> should be set to a large
number. If <code>NULL</code>, then <code>shapr</code> will internally set <code>epochs_early_stopping = vaeac.epochs</code> such that early
stopping does not occur.</p></dd>


<dt>epochs_start</dt>
<dd><p>Positive integer (default is <code>1</code>). At which epoch the training is starting at.</p></dd>


<dt>progressr_bar</dt>
<dd><p>A <code><a href="https://progressr.futureverse.org/reference/progressor.html" class="external-link">progressr::progressor()</a></code> object (default is <code>NULL</code>) to keep track of progress.</p></dd>


<dt>vaeac_save_file_names</dt>
<dd><p>Array of strings containing the save file names for the <code>vaeac</code> model.</p></dd>


<dt>state_list</dt>
<dd><p>Named list containing the objects returned from <code><a href="vaeac_get_full_state_list.html">vaeac_get_full_state_list()</a></code>.</p></dd>


<dt>initialization_idx</dt>
<dd><p>Positive integer (default is <code>NULL</code>). The index
of the current <code>vaeac</code> model in the initialization phase.</p></dd>


<dt>n_vaeacs_initialize</dt>
<dd><p>Positive integer (default is <code>4</code>). The number of different vaeac models to initiate
in the start. Pick the best performing one after <code>epochs_initiation_phase</code>
epochs (default is <code>2</code>) and continue training that one.</p></dd>


<dt>train_vlb</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/torch/man/torch_tensor.html" class="external-link">torch::torch_tensor()</a></code> (default is <code>NULL</code>)
of one dimension containing previous values for the training VLB.</p></dd>


<dt>val_iwae</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/torch/man/torch_tensor.html" class="external-link">torch::torch_tensor()</a></code> (default is <code>NULL</code>)
of one dimension containing previous values for the validation IWAE.</p></dd>


<dt>val_iwae_running</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/torch/man/torch_tensor.html" class="external-link">torch::torch_tensor()</a></code> (default is <code>NULL</code>)
of one dimension containing previous values for the running validation IWAE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Depending on if we are in the initialization phase or not. Then either the trained <code>vaeac</code> model, or
a list of where the <code>vaeac</code> models are stored on disk and the parameters of the model.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Lars Henry Berge Olsen</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nikolai Sellereite, Martin Jullum, Lars Henry Berge Olsen, Annabelle Redelmeier, Jon Lachmann, Norsk Regnesentral.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

      </footer></div>

  


  

  </body></html>

