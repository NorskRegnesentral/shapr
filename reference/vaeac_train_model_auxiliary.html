<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Function used to train a vaeac model — vaeac_train_model_auxiliary • shapr</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function used to train a vaeac model — vaeac_train_model_auxiliary"><meta name="description" content="This function can be applied both in the initialization phase when, we train several initiated vaeac models, and
to keep training the best performing vaeac model for the remaining number of epochs. We are in the former setting
when initialization_idx is provided and the latter when it is NULL. When it is NULL, we save the vaeac models
with lowest VLB, IWAE, running IWAE, and the epochs according to save_every_nth_epoch to disk."><meta property="og:description" content="This function can be applied both in the initialization phase when, we train several initiated vaeac models, and
to keep training the best performing vaeac model for the remaining number of epochs. We are in the former setting
when initialization_idx is provided and the latter when it is NULL. When it is NULL, we save the vaeac models
with lowest VLB, IWAE, running IWAE, and the epochs according to save_every_nth_epoch to disk."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">shapr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/general_usage.html">General usage of shapr</a></li>
    <li><a class="dropdown-item" href="../articles/vaeac.html">Advanced usage of the `vaeac` approach</a></li>
    <li><a class="dropdown-item" href="../articles/regression.html">The separate and surrogate regression approches</a></li>
    <li><a class="dropdown-item" href="../articles/asymmetric_causal.html">Asymmetric and Causal Shapley values</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Manual</a></li>
<li class="nav-item"><a class="nav-link" href="../shaprpy.html">Python</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NorskRegnesentral/shapr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Function used to train a <code>vaeac</code> model</h1>
      <small class="dont-index">Source: <a href="https://github.com/NorskRegnesentral/shapr/blob/master/R/approach_vaeac.R" class="external-link"><code>R/approach_vaeac.R</code></a></small>
      <div class="d-none name"><code>vaeac_train_model_auxiliary.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function can be applied both in the initialization phase when, we train several initiated <code>vaeac</code> models, and
to keep training the best performing <code>vaeac</code> model for the remaining number of epochs. We are in the former setting
when <code>initialization_idx</code> is provided and the latter when it is <code>NULL</code>. When it is <code>NULL</code>, we save the <code>vaeac</code> models
with lowest VLB, IWAE, running IWAE, and the epochs according to <code>save_every_nth_epoch</code> to disk.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vaeac_train_model_auxiliary</span><span class="op">(</span></span>
<span>  <span class="va">vaeac_model</span>,</span>
<span>  <span class="va">optimizer</span>,</span>
<span>  <span class="va">train_dataloader</span>,</span>
<span>  <span class="va">val_dataloader</span>,</span>
<span>  <span class="va">val_iwae_n_samples</span>,</span>
<span>  <span class="va">running_avg_n_values</span>,</span>
<span>  <span class="va">verbose</span>,</span>
<span>  <span class="va">cuda</span>,</span>
<span>  <span class="va">epochs</span>,</span>
<span>  <span class="va">save_every_nth_epoch</span>,</span>
<span>  <span class="va">epochs_early_stopping</span>,</span>
<span>  epochs_start <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  progressr_bar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vaeac_save_file_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  state_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  initialization_idx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_vaeacs_initialize <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  train_vlb <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  val_iwae <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  val_iwae_running <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-vaeac-model">vaeac_model<a class="anchor" aria-label="anchor" href="#arg-vaeac-model"></a></dt>
<dd><p>A <code><a href="vaeac.html">vaeac()</a></code> object. The <code>vaeac</code> model this function is to train.</p></dd>


<dt id="arg-optimizer">optimizer<a class="anchor" aria-label="anchor" href="#arg-optimizer"></a></dt>
<dd><p>A <code><a href="https://torch.mlverse.org/docs/reference/optimizer.html" class="external-link">torch::optimizer()</a></code> object. See <code><a href="vaeac_get_optimizer.html">vaeac_get_optimizer()</a></code>.</p></dd>


<dt id="arg-train-dataloader">train_dataloader<a class="anchor" aria-label="anchor" href="#arg-train-dataloader"></a></dt>
<dd><p>A <code><a href="https://torch.mlverse.org/docs/reference/dataloader.html" class="external-link">torch::dataloader()</a></code> containing the training data for the <code>vaeac</code> model.</p></dd>


<dt id="arg-val-dataloader">val_dataloader<a class="anchor" aria-label="anchor" href="#arg-val-dataloader"></a></dt>
<dd><p>A <code><a href="https://torch.mlverse.org/docs/reference/dataloader.html" class="external-link">torch::dataloader()</a></code> containing the validation data for the <code>vaeac</code> model.</p></dd>


<dt id="arg-val-iwae-n-samples">val_iwae_n_samples<a class="anchor" aria-label="anchor" href="#arg-val-iwae-n-samples"></a></dt>
<dd><p>Positive integer (default is <code>25</code>). The number of generated samples used
to compute the IWAE criterion when validating the vaeac model on the validation data.</p></dd>


<dt id="arg-running-avg-n-values">running_avg_n_values<a class="anchor" aria-label="anchor" href="#arg-running-avg-n-values"></a></dt>
<dd><p>running_avg_n_values Positive integer (default is <code>5</code>).
The number of previous IWAE values to include
when we compute the running means of the IWAE criterion.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>String vector or NULL.
Controls verbosity (printout detail level) via one or more of <code>"basic"</code>, <code>"progress"</code>,
<code>"convergence"</code>, <code>"shapley"</code> and <code>"vS_details"</code>.
<code>"basic"</code> (default) displays basic information about the computation and messages about parameters/checks.
<code>"progress"</code> displays where in the calculation process the function currently is.
<code>"convergence"</code> displays how close the Shapley value estimates are to convergence
(only when <code>iterative = TRUE</code>).
<code>"shapley"</code> displays intermediate Shapley value estimates and standard deviations (only when <code>iterative = TRUE</code>),
and the final estimates.
<code>"vS_details"</code> displays information about the v(S) estimates,
most relevant for <code>approach %in% c("regression_separate", "regression_surrogate", "vaeac")</code>.
<code>NULL</code> means no printout.
Any combination can be used, e.g., <code>verbose = c("basic", "vS_details")</code>.</p></dd>


<dt id="arg-cuda">cuda<a class="anchor" aria-label="anchor" href="#arg-cuda"></a></dt>
<dd><p>Logical (default is <code>FALSE</code>). If <code>TRUE</code>, then the <code>vaeac</code> model will be trained using cuda/GPU.
If <code><a href="https://torch.mlverse.org/docs/reference/cuda_is_available.html" class="external-link">torch::cuda_is_available()</a></code> is <code>FALSE</code>, we fall back to using the CPU. Using a GPU
for smaller tabular dataset often do not improve the efficiency.
See <code><a href="https://torch.mlverse.org/docs/articles/installation.html" class="external-link">vignette("installation", package = "torch")</a></code> fo help to enable running on the GPU (only Linux and Windows).</p></dd>


<dt id="arg-epochs">epochs<a class="anchor" aria-label="anchor" href="#arg-epochs"></a></dt>
<dd><p>Positive integer (default is <code>100</code>). The number of epochs to train the final vaeac model.
This includes <code>epochs_initiation_phase</code>, where the default is <code>2</code>.</p></dd>


<dt id="arg-save-every-nth-epoch">save_every_nth_epoch<a class="anchor" aria-label="anchor" href="#arg-save-every-nth-epoch"></a></dt>
<dd><p>Positive integer (default is <code>NULL</code>). If provided, then the vaeac model after
every <code>save_every_nth_epoch</code>th epoch will be saved.</p></dd>


<dt id="arg-epochs-early-stopping">epochs_early_stopping<a class="anchor" aria-label="anchor" href="#arg-epochs-early-stopping"></a></dt>
<dd><p>Positive integer (default is <code>NULL</code>). The training stops if there has been no
improvement in the validation IWAE for <code>epochs_early_stopping</code> epochs. If the user wants the training process
to be solely based on this training criterion, then <code>epochs</code> in <code><a href="explain.html">explain()</a></code> should be set to a large
number. If <code>NULL</code>, then <code>shapr</code> will internally set <code>epochs_early_stopping = vaeac.epochs</code> such that early
stopping does not occur.</p></dd>


<dt id="arg-epochs-start">epochs_start<a class="anchor" aria-label="anchor" href="#arg-epochs-start"></a></dt>
<dd><p>Positive integer (default is <code>1</code>). At which epoch the training is starting at.</p></dd>


<dt id="arg-progressr-bar">progressr_bar<a class="anchor" aria-label="anchor" href="#arg-progressr-bar"></a></dt>
<dd><p>A <code><a href="https://progressr.futureverse.org/reference/progressor.html" class="external-link">progressr::progressor()</a></code> object (default is <code>NULL</code>) to keep track of progress.</p></dd>


<dt id="arg-vaeac-save-file-names">vaeac_save_file_names<a class="anchor" aria-label="anchor" href="#arg-vaeac-save-file-names"></a></dt>
<dd><p>Array of strings containing the save file names for the <code>vaeac</code> model.</p></dd>


<dt id="arg-state-list">state_list<a class="anchor" aria-label="anchor" href="#arg-state-list"></a></dt>
<dd><p>Named list containing the objects returned from <code><a href="vaeac_get_full_state_list.html">vaeac_get_full_state_list()</a></code>.</p></dd>


<dt id="arg-initialization-idx">initialization_idx<a class="anchor" aria-label="anchor" href="#arg-initialization-idx"></a></dt>
<dd><p>Positive integer (default is <code>NULL</code>). The index
of the current <code>vaeac</code> model in the initialization phase.</p></dd>


<dt id="arg-n-vaeacs-initialize">n_vaeacs_initialize<a class="anchor" aria-label="anchor" href="#arg-n-vaeacs-initialize"></a></dt>
<dd><p>Positive integer (default is <code>4</code>). The number of different vaeac models to initiate
in the start. Pick the best performing one after <code>epochs_initiation_phase</code>
epochs (default is <code>2</code>) and continue training that one.</p></dd>


<dt id="arg-train-vlb">train_vlb<a class="anchor" aria-label="anchor" href="#arg-train-vlb"></a></dt>
<dd><p>A <code><a href="https://torch.mlverse.org/docs/reference/torch_tensor.html" class="external-link">torch::torch_tensor()</a></code> (default is <code>NULL</code>)
of one dimension containing previous values for the training VLB.</p></dd>


<dt id="arg-val-iwae">val_iwae<a class="anchor" aria-label="anchor" href="#arg-val-iwae"></a></dt>
<dd><p>A <code><a href="https://torch.mlverse.org/docs/reference/torch_tensor.html" class="external-link">torch::torch_tensor()</a></code> (default is <code>NULL</code>)
of one dimension containing previous values for the validation IWAE.</p></dd>


<dt id="arg-val-iwae-running">val_iwae_running<a class="anchor" aria-label="anchor" href="#arg-val-iwae-running"></a></dt>
<dd><p>A <code><a href="https://torch.mlverse.org/docs/reference/torch_tensor.html" class="external-link">torch::torch_tensor()</a></code> (default is <code>NULL</code>)
of one dimension containing previous values for the running validation IWAE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Depending on if we are in the initialization phase or not. Then either the trained <code>vaeac</code> model, or
a list of where the <code>vaeac</code> models are stored on disk and the parameters of the model.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lars Henry Berge Olsen</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Jullum, Lars Henry Berge Olsen, Annabelle Redelmeier, Jon Lachmann, Nikolai Sellereite, Norsk Regnesentral.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

